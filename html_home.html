<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Roster Access Project</title>
    <link rel="icon" href="https://static-assets-5sa.pages.dev/roster/favicon.svg" type="image/svg">
    <style type="text/css"> 
      h1 {
        text-align: center;
      }
      body {
        background-color: #f0f0f2;
        margin: 0;
        padding: 0;
        font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
      }
      #main {
        width: 600px;
        margin: 5em auto;
        padding: 2em;
        background-color: #fdfdff;
        border-radius: 0.5em;
        box-shadow: 2px 3px 7px 2px rgba(0,0,0,0.02);
      }
      .collapsible {
      background-color: #777;
      color: white;
      cursor: pointer;
      padding: 18px;
      width: 100%;
      border: none;
      text-align: centre;
      outline: none;
      font-size: 15px;
      }
      .content {
      padding: 0 18px;
      display: none;
      overflow: hidden;
      background-color: #f1f1f1;
      }
      .active, .collapsible:hover {
      background-color: #555;
      }
      a:link, a:visited { color: #6911Ff; text-decoration: none;}
      @media (max-width: 700px)
        { div { margin: 0 auto; width: auto;}}
    </style>
  </head>
  <body>
    <div id="main">
      <h1>Roster Access Project</h1>
      <p>You can generate your personal Air Maestro External Link by scrolling to the bottom of the Schedule page once you log into Air Maestro.</p>
      <p>Copy the External Link from Air Maestro and paste it in the field below and click "Generate". A new link that you need to use in any calendar service you choose.</p>
      <p><mark><b>Note:</b> This new link will be copied to your clipboard to help adding it to your calendar service.</mark></p>

      <form id="myform">
        <label for="amLink">Paste Air Maestro External Link Here:</label><br>
        <input type="text" id="amLink" name="amLink" size="50"><br><br>
        <button type="button" id="generateBtn">Generate</button>
      </form>
      <div id="gerneratedLink" style="display: none; word-wrap: anywhere; border: 1px solid #ccc"></div><br>
      <script>
        let text = document.getElementById('gerneratedLink');
        generateBtn.onclick = function generateLink(){
          text.textContent = window.location.toString() + "?url=" + document.getElementById('amLink').value;
          gerneratedLink.style.display="block";
          navigator.clipboard.writeText(text.textContent)
            .then(() => {
              alert('Text copied to clipboard');
            })
            .catch(err => {
              alert('Error in copying text: ', err);
            });
        };
      </script>
      <p><a href="https://calendar.google.com" target="_blank"><img src="https://static-assets-5sa.pages.dev/roster/icons/Google_Calendar.svg" alt="Google Calendar" width="48" height="48"></a>
         <a href="https://outlook.live.com/calendar/" target="_blank"><img src="https://static-assets-5sa.pages.dev/roster/icons/MS_Outlook.svg" alt="Microsoft Outlook Calendar" width="48" height="48"></a>
         <a href="https://www.icloud.com/calendar/" target="_blank"><img src="https://static-assets-5sa.pages.dev/roster/icons/Apple_Calendar_macOS_round.png" alt="Apple Calendar" width="48" height="48"></a></p>
        <h2>Air Maestro via Okta has the final say!</h2>
        <p>The information below will provide additional information about this project but remember that Air Maestro via Okta along with any calls or messages from Operations has the final say. This should reflect any changes within Air Maestro but remember it may take up to 24 hours depending on the calendar service you subscribe to. It’s an additional tool to make everyone’s life easier with checking the roster for next weekends party plans but I will not accept any responsibility for anyone missing or running late for shifts.</p>
        <button type="button" class="collapsible"><b>What this link does</b></button>
        <div class="content">
          <p>This Project retrieves your calendar from Air Maestro and adjusts the following;
            <ul>
              <li>All times zones for each event is adjusted to UTC,</li>
              <li>Duplicate Leave types removed,</li>
              <li>Duplicate Day Off types removed,</li>
              <li>Duplicate Standby events removed,</li>
              <li>Duplicate Admin events removed,</li>
              <li>Assigned Base events removed.</li>
            </ul>
          </p>
        </div>
        <p></p>
        <button type="button" class="collapsible"><b>FAQs</b></button>
        <div class="content">
          <p>
            <ul>
              <li>Each update request from your calendar service is retrieved, filtered and pushed to calendar,</li>
              <li>Nothing is saved within this online project,</li>
              <li>Event start times will display in your local calendar time – If you have a 0600H sign on in Broome but your phone is still on Darwin Time, the event will show as 0730I/K until your phone clock updates to WA,</li>
              <li>If you generate a new link in Air Maestro – you will need to generate a new link with this website,</li>
              <li>Depending on your calendar service, it may take a short time to initially populate with events (anywhere from 5 minutes to 1 hour),</li>
              <li>Updates may occur only once every 24 hours but depending on your calendar service, this is likely closer to every 6 hours.</li>
            </ul>
          I have adjusted this to suite the many but if you have any suggestions or things that could be improved, please let me know.</p>
        </div>
      <p>Air Maestro provider Avinet has an existing how-to guide for various platforms <a href="https://avinet.atlassian.net/wiki/spaces/AMKB/pages/816218113" target="_blank">here</a>, but eventually updated instructions will be provided below for use with Outlook Web and Google Calendar.</p>
      <p><mark><b>Note:</b> Currently adding an external calendar to the using a <u>company managed Outlook Desktop program is not supported</u>.</mark></p>
      <p>The calendar will show up in the Desktop version shortly after adding the external subscription using the Outlook Web method.</p>
        <button type="button" class="collapsible"><b>Outlook Online Web App</b></button>
        <div class="content">
          <p>
            <ul>
              <li>UPDATED INSTRUCTIONS WILL GO HERE</li>
            </ul>
          </p>
        </div>
        <p></p>
        <button type="button" class="collapsible"><b>Google Calendar</b></button>
        <div class="content">
          <p>
            <ul>
              <li>UPDATED INSTRUCTIONS WILL GO HERE</li>
            </ul>
          </p>
        </div>
      <p>If you have any questions regarding how this workaround is built, feel free to review the code on <a href="https://github.com/123gizi/cloudflare-roster-proxy" target="_blank">GitHub</a> and if you’re interested in a faster sync option for use with Google Calendars, you can check out this <a href="https://github.com/derekantrican/GAS-ICS-Sync" target="_blank">Google Apps Script</a> - but it’s not for beginners and not without additional difficulties.</p>
      <script>
      var coll = document.getElementsByClassName("collapsible");
      var i;

      for (i = 0; i < coll.length; i++) {
        coll[i].addEventListener("click", function() {
          this.classList.toggle("active");
          var content = this.nextElementSibling;
          if (content.style.display === "block") {
            content.style.display = "none";
          } else {
            content.style.display = "block";
          }
        });
      }
      </script>
    </div>
  </body>
</html>
